#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <Arduino.h>
#include <SoftwareSerial.h>
#define SOFT_TX 5
#define SOFT_RX 6
// [ PMSx003xx TX ] to [ Arduino PIN 11 ]
SoftwareSerial mySerial(SOFT_RX, SOFT_TX); // RX, TX
unsigned char gucRxBuf[100];
unsigned int pmcount25;
float temp=0.0;
float humi=0.0;

#define SCREEN_WIDTH 128 // OLED display width, in pixels
#define SCREEN_HEIGHT 64 // OLED display height, in pixels

// Declaration for SSD1306 display connected using software SPI (default case):
#define OLED_MOSI   9//SDA
#define OLED_CLK   10//SCL
#define OLED_DC    11
#define OLED_CS    12//它不用接
#define OLED_RESET 13
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT,
  OLED_MOSI, OLED_CLK, OLED_DC, OLED_RESET, OLED_CS);

#define LOGO_HEIGHT   64
#define LOGO_WIDTH   128
static const unsigned char PROGMEM logo_bmp[] =
{ B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00001110,B00000001,B11111111,B10000000,B01110000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00011111,B00000111,B11111111,B11100000,B11111000,B00000000,B00000000,B01111111,B11111110,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B10111111,B11111111,B11111101,B11111110,B00000000,B00000011,B11111111,B11111111,B11000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00001111,B11111111,B11111111,B11110000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00111111,B11111111,B11111111,B11111100,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B01111111,B11111111,B11111111,B11111110,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000001,B11111111,B11111111,B11111111,B11111111,B10000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111111,B11111111,B11111111,B11111110,B00000011,B11111111,B11111111,B11111111,B11111111,B11000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111110,B00000000,B01111111,B11111110,B00000111,B11111111,B11100000,B00000111,B11111111,B11100000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11110000,B00000000,B00001111,B11111111,B00001111,B11111111,B00000000,B00000000,B11111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11100000,B00000000,B00000011,B11111111,B00001111,B11111110,B00000000,B00000000,B01111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000001,B11111111,B10011111,B11111000,B00000011,B10000000,B00011111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111111,B00001000,B00000000,B00000000,B11111111,B10111111,B11110000,B01111111,B11111100,B00001111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111110,B00001111,B11111111,B11111000,B01111111,B10111111,B11100011,B11111111,B11111110,B00000111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111100,B00001111,B11111111,B11110000,B00111111,B01111111,B11000011,B11111111,B11111111,B10000011,B11111110,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111000,B00001111,B11111111,B11110000,B00011111,B01111111,B10000001,B11111111,B11111111,B11000001,B11111110,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00001111,B11111111,B11100000,B00001110,B11111111,B00000001,B11111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00011111,B11111111,B11100000,B00001110,B11111111,B00000000,B11111111,B11111111,B11110000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00011111,B11111111,B11100000,B00000000,B11111110,B00000000,B11100000,B00011111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000000,B00011111,B11000000,B00000001,B11111110,B00000000,B01000000,B00000111,B11111000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11000000,B00000000,B00111111,B11000000,B00000001,B11111100,B00000000,B00000000,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B11111111,B11000000,B00000000,B00111111,B10000000,B00000001,B11111100,B00000000,B00001111,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00111111,B11000000,B00000000,B00111111,B11000000,B00000001,B11111100,B00000000,B11111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11110000,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11111000,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B11111111,B11111100,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11111110,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B00000001,B11111110,B00000001,B11111000,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B00000000,B11111110,B00000011,B11111000,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00111111,B11000000,B00000000,B00000000,B01111110,B00000011,B11111000,B00000000,B01111111,B00000001,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B11111111,B11000000,B00000000,B00000000,B01111110,B00000011,B11111000,B00000000,B01111111,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11000000,B00000000,B00000000,B01111111,B00000011,B11111000,B00000000,B01111111,B00000111,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000010,B00000000,B01111110,B00000111,B11111000,B00000000,B01111111,B00000111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000110,B00000000,B11111110,B00000111,B11111000,B00000000,B01111111,B00011111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00000111,B10000001,B11111110,B00001111,B11110111,B00000000,B01111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00001111,B11111111,B11111110,B00001111,B11110111,B00000000,B01111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111000,B00001111,B11111111,B11111100,B00011111,B11100111,B10000000,B01111111,B11111111,B11000001,B11111110,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111100,B00011111,B11111111,B11111100,B00111111,B11101111,B11000000,B01111111,B11111111,B10000011,B11111110,B00000000,B00000000,
  B00000000,B00000000,B01110111,B11111110,B00011111,B11111111,B11111000,B00111111,B11001111,B11100000,B01111111,B11111110,B00000111,B11111110,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111111,B00001111,B11111111,B11110000,B11111111,B11011111,B11110000,B11111111,B11111000,B00001111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B10000011,B11111111,B11000001,B11111111,B10011111,B11111000,B11111111,B00000000,B00011111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B11000000,B00111110,B00000011,B11111111,B10011111,B11111100,B00000000,B00000000,B00111111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11110000,B00000000,B00001111,B11111111,B00001111,B11111111,B00000000,B00000000,B11111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111110,B00000000,B00111111,B11111110,B00000111,B11111111,B11000000,B00000011,B11111111,B11100000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111111,B11000011,B11111111,B11111110,B00000011,B11111111,B11111100,B00111111,B11111111,B11000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000001,B11111111,B11111111,B11111111,B11111111,B10000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B01111111,B11111111,B11111111,B11111111,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00111111,B11111111,B11111111,B11111100,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00001111,B11111111,B11111111,B11110000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B10111111,B11111111,B11111111,B11111110,B00000000,B00000111,B11111111,B11111111,B11100000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00111111,B00000111,B11111111,B11100000,B11111000,B00000000,B00000000,B01111111,B11111110,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00001110,B00000001,B11111111,B10000000,B01110000,B00000000,B00000000,B00000011,B11000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000
 };
#include <Bounce.h>
const int bt1 =2;
const int bt2 =4;
Bounce  bts1=Bounce(2, 50);
Bounce  bts2=Bounce(4, 50);
int btany=0;
void setup() {
  Serial.begin(9600);
  mySerial.begin(9600);
   display.begin(9600);
pinMode(bt1,INPUT);
pinMode(bt2,INPUT);

}
void loop() {
pm();
//bts1=digitalRead(bt1);
//bts2=digitalRead(bt2);
if(bts1.update() == true && bts1.read() == HIGH){
  btany+=1;
  //delay(100);
  }
if(bts2.update() == true && bts2.read() == HIGH){
  btany-=1;
 // delay(100);
  }
  if(btany<0 ){
    btany=2;
  }else if(btany>2){
    btany=0;
    }
switch (btany) {
  case 0:
  display.clearDisplay();
  display.setTextSize(2);             
  display.setTextColor(WHITE);        
  display.setCursor(30,20);             
  display.println("Hello");
  display.display();
    break;
  case 1:
  display.clearDisplay();
  display.drawBitmap(0,0, logo_bmp, SCREEN_WIDTH, SCREEN_HEIGHT, WHITE);
  display.display();
    break;
  case 2:  
    display.clearDisplay();
    display.setTextSize(2);            
    display.setTextColor(WHITE);        
    display.setCursor(0,0);
    display.print("C:");
    display.println(temp);
    display.setTextSize(2);            
    display.setTextColor(WHITE);        
    display.setCursor(0,25);
    display.print("H:");
    display.println(humi);
    display.setTextSize(2);            
    display.setTextColor(WHITE);       
    display.setCursor(0,50);               
    display.println("PM2.5:"+String(pmcount25));
    display.display();
    break;
    }
  Serial.println(btany);
}
