#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <Arduino.h>
#include <DS3231.h>
DS3231  rtc(SDA, SCL);
String any;

#include <dht.h>   
#define dht_dpin 8 //定義訊號要從Pin 8 進來  
dht DHT;  
String th;
#define SCREEN_WIDTH 128 // OLED display width, in pixels
#define SCREEN_HEIGHT 64 // OLED display height, in pixels

// Declaration for SSD1306 display connected using software SPI (default case):
#define OLED_MOSI   9//SDA
#define OLED_CLK   10//SCL
#define OLED_DC    11
#define OLED_CS    12
#define OLED_RESET 13
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT,
  OLED_MOSI, OLED_CLK, OLED_DC, OLED_RESET, OLED_CS);

#define LOGO_HEIGHT   64
#define LOGO_WIDTH   128
static const unsigned char PROGMEM logo_bmp[] =
{ B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00001110,B00000001,B11111111,B10000000,B01110000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00011111,B00000111,B11111111,B11100000,B11111000,B00000000,B00000000,B01111111,B11111110,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B10111111,B11111111,B11111101,B11111110,B00000000,B00000011,B11111111,B11111111,B11000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00001111,B11111111,B11111111,B11110000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00111111,B11111111,B11111111,B11111100,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B01111111,B11111111,B11111111,B11111110,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000001,B11111111,B11111111,B11111111,B11111111,B10000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111111,B11111111,B11111111,B11111110,B00000011,B11111111,B11111111,B11111111,B11111111,B11000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111110,B00000000,B01111111,B11111110,B00000111,B11111111,B11100000,B00000111,B11111111,B11100000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11110000,B00000000,B00001111,B11111111,B00001111,B11111111,B00000000,B00000000,B11111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11100000,B00000000,B00000011,B11111111,B00001111,B11111110,B00000000,B00000000,B01111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000001,B11111111,B10011111,B11111000,B00000011,B10000000,B00011111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111111,B00001000,B00000000,B00000000,B11111111,B10111111,B11110000,B01111111,B11111100,B00001111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111110,B00001111,B11111111,B11111000,B01111111,B10111111,B11100011,B11111111,B11111110,B00000111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111100,B00001111,B11111111,B11110000,B00111111,B01111111,B11000011,B11111111,B11111111,B10000011,B11111110,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111000,B00001111,B11111111,B11110000,B00011111,B01111111,B10000001,B11111111,B11111111,B11000001,B11111110,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00001111,B11111111,B11100000,B00001110,B11111111,B00000001,B11111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00011111,B11111111,B11100000,B00001110,B11111111,B00000000,B11111111,B11111111,B11110000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00011111,B11111111,B11100000,B00000000,B11111110,B00000000,B11100000,B00011111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000000,B00011111,B11000000,B00000001,B11111110,B00000000,B01000000,B00000111,B11111000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11000000,B00000000,B00111111,B11000000,B00000001,B11111100,B00000000,B00000000,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B11111111,B11000000,B00000000,B00111111,B10000000,B00000001,B11111100,B00000000,B00001111,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00111111,B11000000,B00000000,B00111111,B11000000,B00000001,B11111100,B00000000,B11111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11110000,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11111000,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B11111111,B11111100,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B01111111,B11111110,B00000001,B11111100,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B00000001,B11111110,B00000001,B11111000,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00011111,B11000000,B00000000,B00000000,B11111110,B00000011,B11111000,B00000000,B01111111,B00000001,B11111100,B00111111,B10000000,B00000000,
  B00000000,B00000000,B00111111,B11000000,B00000000,B00000000,B01111110,B00000011,B11111000,B00000000,B01111111,B00000001,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000000,B11111111,B11000000,B00000000,B00000000,B01111110,B00000011,B11111000,B00000000,B01111111,B00000011,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11000000,B00000000,B00000000,B01111111,B00000011,B11111000,B00000000,B01111111,B00000111,B11111000,B00111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000010,B00000000,B01111110,B00000111,B11111000,B00000000,B01111111,B00000111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11100000,B00000110,B00000000,B11111110,B00000111,B11111000,B00000000,B01111111,B00011111,B11110000,B01111111,B10000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00000111,B10000001,B11111110,B00001111,B11110111,B00000000,B01111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000001,B11111111,B11110000,B00001111,B11111111,B11111110,B00001111,B11110111,B00000000,B01111111,B11111111,B11100000,B11111111,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111000,B00001111,B11111111,B11111100,B00011111,B11100111,B10000000,B01111111,B11111111,B11000001,B11111110,B00000000,B00000000,
  B00000000,B00000000,B11111111,B11111100,B00011111,B11111111,B11111100,B00111111,B11101111,B11000000,B01111111,B11111111,B10000011,B11111110,B00000000,B00000000,
  B00000000,B00000000,B01110111,B11111110,B00011111,B11111111,B11111000,B00111111,B11001111,B11100000,B01111111,B11111110,B00000111,B11111110,B00000000,B00000000,
  B00000000,B00000000,B00000011,B11111111,B00001111,B11111111,B11110000,B11111111,B11011111,B11110000,B11111111,B11111000,B00001111,B11111100,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B10000011,B11111111,B11000001,B11111111,B10011111,B11111000,B11111111,B00000000,B00011111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000001,B11111111,B11000000,B00111110,B00000011,B11111111,B10011111,B11111100,B00000000,B00000000,B00111111,B11111000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11110000,B00000000,B00001111,B11111111,B00001111,B11111111,B00000000,B00000000,B11111111,B11110000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111110,B00000000,B00111111,B11111110,B00000111,B11111111,B11000000,B00000011,B11111111,B11100000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B11111111,B11000011,B11111111,B11111110,B00000011,B11111111,B11111100,B00111111,B11111111,B11000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000001,B11111111,B11111111,B11111111,B11111111,B10000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B01111111,B11111111,B11111111,B11111111,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00111111,B11111111,B11111111,B11111100,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B11111111,B11111111,B11111111,B11111111,B11111111,B00000000,B00001111,B11111111,B11111111,B11110000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B01111111,B10111111,B11111111,B11111111,B11111110,B00000000,B00000111,B11111111,B11111111,B11100000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00111111,B00000111,B11111111,B11100000,B11111000,B00000000,B00000000,B01111111,B11111110,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00001110,B00000001,B11111111,B10000000,B01110000,B00000000,B00000000,B00000011,B11000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000001,B11111111,B10000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B11111111,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000
 };

void setup() {
  Serial.begin(9600);
  display.begin(9600);
  rtc.begin();
//rtcs();//改完記得註解起來再重新上傳一次
display.clearDisplay();
display.drawBitmap(0,0, logo_bmp, SCREEN_WIDTH, SCREEN_HEIGHT, WHITE);
display.display();
delay(3000);
display.clearDisplay();
}

void loop() { 
  DHT.read11(dht_dpin);
  //display.clearDisplay();
  display.clearDisplay();
/* any=(String(rtc.getDOWStr())+" "+String(rtc.getDateStr())+"--"+String(rtc.getTimeStr())); 
 //any=(String(rtc.getDateStr())+"-"+String(rtc.getTimeStr())); 
  display.setTextSize(2);             // Normal 1:1 pixel scale字型大小
  display.setTextColor(WHITE);        // Draw white text
  display.setCursor(0,0);             // Start at top-left corner
  display.println(rtc.getDOWStr());
  //display.display();
  display.setTextSize(2);             // Normal 1:1 pixel scale
  display.setTextColor(WHITE);        // Draw white text
  display.setCursor(0,16);             // Start at top-left corner
  display.println(rtc.getDateStr());
 // display.display();
  display.setTextSize(2);             // Normal 1:1 pixel scale
  display.setTextColor(WHITE);        // Draw white text
  display.setCursor(0,32);             // Start at top-left corner
  display.println(rtc.getTimeStr());
 // display.display();*/
  th=("H:"+String(DHT.humidity)+"  C:"+String(DHT.temperature)); 
  display.setTextSize(1);             // Normal 1:1 pixel scale
  display.setTextColor(WHITE);        // Draw white text
  display.setCursor(0,48);             // Start at top-left corner
  display.println(th);
  display.display();
  delay(10);
}
